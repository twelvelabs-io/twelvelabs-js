/**
 * This file was auto-generated by Fern from our API Definition.
 */

import * as environments from "../../../../../../environments";
import * as core from "../../../../../../core";
import * as TwelvelabsApi from "../../../../../index";
import * as serializers from "../../../../../../serialization/index";
import urlJoin from "url-join";
import * as errors from "../../../../../../errors/index";

export declare namespace Entities {
    export interface Options {
        environment?: core.Supplier<environments.TwelvelabsApiEnvironment | string>;
        /** Specify a custom URL to connect the client to. */
        baseUrl?: core.Supplier<string>;
        apiKey: core.Supplier<string>;
    }

    export interface RequestOptions {
        /** The maximum time to wait for a response in seconds. */
        timeoutInSeconds?: number;
        /** The number of times to retry the request. Defaults to 2. */
        maxRetries?: number;
        /** A hook to abort the request. */
        abortSignal?: AbortSignal;
        /** Additional headers to include in the request. */
        headers?: Record<string, string>;
    }
}

export class Entities {
    constructor(protected readonly _options: Entities.Options) {}

    /**
     * This method returns a list of the entities in the specified entity collection.
     *
     * @param {string} entityCollectionId - The unique identifier of the entity collection for which the platform will retrieve the entities.
     * @param {TwelvelabsApi.entityCollections.EntitiesListRequest} request
     * @param {Entities.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link TwelvelabsApi.BadRequestError}
     *
     * @example
     *     await client.entityCollections.entities.list("6298d673f1090f1100476d4c", {
     *         page: 1,
     *         pageLimit: 10,
     *         name: "My entity",
     *         status: "processing",
     *         sortBy: "created_at",
     *         sortOption: "desc"
     *     })
     */
    public async list(
        entityCollectionId: string,
        request: TwelvelabsApi.entityCollections.EntitiesListRequest = {},
        requestOptions?: Entities.RequestOptions,
    ): Promise<core.Page<TwelvelabsApi.Entity>> {
        const list = core.HttpResponsePromise.interceptFunction(
            async (
                request: TwelvelabsApi.entityCollections.EntitiesListRequest,
            ): Promise<core.WithRawResponse<TwelvelabsApi.entityCollections.EntitiesListResponse>> => {
                const { page, pageLimit, name, status, sortBy, sortOption } = request;
                const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
                if (page != null) {
                    _queryParams["page"] = page.toString();
                }
                if (pageLimit != null) {
                    _queryParams["page_limit"] = pageLimit.toString();
                }
                if (name != null) {
                    _queryParams["name"] = name;
                }
                if (status != null) {
                    _queryParams["status"] = serializers.entityCollections.EntitiesListRequestStatus.jsonOrThrow(
                        status,
                        { unrecognizedObjectKeys: "strip" },
                    );
                }
                if (sortBy != null) {
                    _queryParams["sort_by"] = serializers.entityCollections.EntitiesListRequestSortBy.jsonOrThrow(
                        sortBy,
                        { unrecognizedObjectKeys: "strip" },
                    );
                }
                if (sortOption != null) {
                    _queryParams["sort_option"] = sortOption;
                }
                const _response = await core.fetcher({
                    url: urlJoin(
                        (await core.Supplier.get(this._options.baseUrl)) ??
                            (await core.Supplier.get(this._options.environment)) ??
                            environments.TwelvelabsApiEnvironment.Default,
                        `entity-collections/${encodeURIComponent(entityCollectionId)}/entities`,
                    ),
                    method: "GET",
                    headers: {
                        "X-Fern-Language": "JavaScript",
                        "X-Fern-SDK-Name": "twelvelabs-js",
                        "X-Fern-SDK-Version": "1.2.0-beta.0",
                        "User-Agent": "twelvelabs-js/1.2.0-beta.0",
                        "X-Fern-Runtime": core.RUNTIME.type,
                        "X-Fern-Runtime-Version": core.RUNTIME.version,
                        ...(await this._getCustomAuthorizationHeaders()),
                        ...requestOptions?.headers,
                    },
                    contentType: "application/json",
                    queryParameters: _queryParams,
                    requestType: "json",
                    timeoutMs:
                        requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
                    maxRetries: requestOptions?.maxRetries,
                    abortSignal: requestOptions?.abortSignal,
                });
                if (_response.ok) {
                    return {
                        data: serializers.entityCollections.EntitiesListResponse.parseOrThrow(_response.body, {
                            unrecognizedObjectKeys: "passthrough",
                            allowUnrecognizedUnionMembers: true,
                            allowUnrecognizedEnumValues: true,
                            breadcrumbsPrefix: ["response"],
                        }),
                        rawResponse: _response.rawResponse,
                    };
                }
                if (_response.error.reason === "status-code") {
                    switch (_response.error.statusCode) {
                        case 400:
                            throw new TwelvelabsApi.BadRequestError(_response.error.body, _response.rawResponse);
                        default:
                            throw new errors.TwelvelabsApiError({
                                statusCode: _response.error.statusCode,
                                body: _response.error.body,
                                rawResponse: _response.rawResponse,
                            });
                    }
                }
                switch (_response.error.reason) {
                    case "non-json":
                        throw new errors.TwelvelabsApiError({
                            statusCode: _response.error.statusCode,
                            body: _response.error.rawBody,
                            rawResponse: _response.rawResponse,
                        });
                    case "timeout":
                        throw new errors.TwelvelabsApiTimeoutError(
                            "Timeout exceeded when calling GET /entity-collections/{entity_collection_id}/entities.",
                        );
                    case "unknown":
                        throw new errors.TwelvelabsApiError({
                            message: _response.error.errorMessage,
                            rawResponse: _response.rawResponse,
                        });
                }
            },
        );
        let _offset = request?.page != null ? request?.page : 1;
        const dataWithRawResponse = await list(request).withRawResponse();
        return new core.Pageable<TwelvelabsApi.entityCollections.EntitiesListResponse, TwelvelabsApi.Entity>({
            response: dataWithRawResponse.data,
            rawResponse: dataWithRawResponse.rawResponse,
            hasNextPage: (response) => (response?.data ?? []).length > 0,
            getItems: (response) => response?.data ?? [],
            loadPage: (_response) => {
                _offset += 1;
                return list(core.setObjectProperty(request, "page", _offset));
            },
        });
    }

    /**
     * This method creates an entity within a specified entity collection. Each entity must be associated with at least one asset.
     *
     * @param {string} entityCollectionId - The unique identifier of the entity collection in which to create the entity.
     * @param {TwelvelabsApi.entityCollections.EntitiesCreateRequest} request
     * @param {Entities.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link TwelvelabsApi.BadRequestError}
     *
     * @example
     *     await client.entityCollections.entities.create("6298d673f1090f1100476d4c", {
     *         name: "My entity",
     *         assetIds: ["6298d673f1090f1100476d4c", "6298d673f1090f1100476d4d"]
     *     })
     */
    public create(
        entityCollectionId: string,
        request: TwelvelabsApi.entityCollections.EntitiesCreateRequest,
        requestOptions?: Entities.RequestOptions,
    ): core.HttpResponsePromise<TwelvelabsApi.Entity> {
        return core.HttpResponsePromise.fromPromise(this.__create(entityCollectionId, request, requestOptions));
    }

    private async __create(
        entityCollectionId: string,
        request: TwelvelabsApi.entityCollections.EntitiesCreateRequest,
        requestOptions?: Entities.RequestOptions,
    ): Promise<core.WithRawResponse<TwelvelabsApi.Entity>> {
        const _response = await core.fetcher({
            url: urlJoin(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.TwelvelabsApiEnvironment.Default,
                `entity-collections/${encodeURIComponent(entityCollectionId)}/entities`,
            ),
            method: "POST",
            headers: {
                "X-Fern-Language": "JavaScript",
                "X-Fern-SDK-Name": "twelvelabs-js",
                "X-Fern-SDK-Version": "1.2.0-beta.0",
                "User-Agent": "twelvelabs-js/1.2.0-beta.0",
                "X-Fern-Runtime": core.RUNTIME.type,
                "X-Fern-Runtime-Version": core.RUNTIME.version,
                ...(await this._getCustomAuthorizationHeaders()),
                ...requestOptions?.headers,
            },
            contentType: "application/json",
            requestType: "json",
            body: serializers.entityCollections.EntitiesCreateRequest.jsonOrThrow(request, {
                unrecognizedObjectKeys: "strip",
            }),
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.Entity.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new TwelvelabsApi.BadRequestError(_response.error.body, _response.rawResponse);
                default:
                    throw new errors.TwelvelabsApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.TwelvelabsApiError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.TwelvelabsApiTimeoutError(
                    "Timeout exceeded when calling POST /entity-collections/{entity_collection_id}/entities.",
                );
            case "unknown":
                throw new errors.TwelvelabsApiError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * This method creates multiple entities within a specified entity collection in a single request. Each entity must be associated with at least one asset. This endpoint is useful for efficiently adding multiple entities, such as a roster of players or a group of characters.
     *
     * @param {string} entityCollectionId - The unique identifier of the entity collection in which to create the entities.
     * @param {TwelvelabsApi.entityCollections.EntitiesCreateBulkRequest} request
     * @param {Entities.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link TwelvelabsApi.BadRequestError}
     *
     * @example
     *     await client.entityCollections.entities.createBulk("6298d673f1090f1100476d4c", {
     *         entities: [{
     *                 name: "My entity",
     *                 assetIds: ["6298d673f1090f1100476d4c", "6298d673f1090f1100476d4d"]
     *             }]
     *     })
     */
    public createBulk(
        entityCollectionId: string,
        request: TwelvelabsApi.entityCollections.EntitiesCreateBulkRequest,
        requestOptions?: Entities.RequestOptions,
    ): core.HttpResponsePromise<TwelvelabsApi.BulkCreateEntityResponse> {
        return core.HttpResponsePromise.fromPromise(this.__createBulk(entityCollectionId, request, requestOptions));
    }

    private async __createBulk(
        entityCollectionId: string,
        request: TwelvelabsApi.entityCollections.EntitiesCreateBulkRequest,
        requestOptions?: Entities.RequestOptions,
    ): Promise<core.WithRawResponse<TwelvelabsApi.BulkCreateEntityResponse>> {
        const _response = await core.fetcher({
            url: urlJoin(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.TwelvelabsApiEnvironment.Default,
                `entity-collections/${encodeURIComponent(entityCollectionId)}/entities/bulk`,
            ),
            method: "POST",
            headers: {
                "X-Fern-Language": "JavaScript",
                "X-Fern-SDK-Name": "twelvelabs-js",
                "X-Fern-SDK-Version": "1.2.0-beta.0",
                "User-Agent": "twelvelabs-js/1.2.0-beta.0",
                "X-Fern-Runtime": core.RUNTIME.type,
                "X-Fern-Runtime-Version": core.RUNTIME.version,
                ...(await this._getCustomAuthorizationHeaders()),
                ...requestOptions?.headers,
            },
            contentType: "application/json",
            requestType: "json",
            body: serializers.entityCollections.EntitiesCreateBulkRequest.jsonOrThrow(request, {
                unrecognizedObjectKeys: "strip",
            }),
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.BulkCreateEntityResponse.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new TwelvelabsApi.BadRequestError(_response.error.body, _response.rawResponse);
                default:
                    throw new errors.TwelvelabsApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.TwelvelabsApiError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.TwelvelabsApiTimeoutError(
                    "Timeout exceeded when calling POST /entity-collections/{entity_collection_id}/entities/bulk.",
                );
            case "unknown":
                throw new errors.TwelvelabsApiError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * This method retrieves details about the specified entity.
     *
     * @param {string} entityCollectionId - The unique identifier of the entity collection.
     * @param {string} entityId - The unique identifier of the entity to retrieve.
     * @param {Entities.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link TwelvelabsApi.BadRequestError}
     *
     * @example
     *     await client.entityCollections.entities.retrieve("6298d673f1090f1100476d4c", "6298d673f1090f1100476d4c")
     */
    public retrieve(
        entityCollectionId: string,
        entityId: string,
        requestOptions?: Entities.RequestOptions,
    ): core.HttpResponsePromise<TwelvelabsApi.Entity> {
        return core.HttpResponsePromise.fromPromise(this.__retrieve(entityCollectionId, entityId, requestOptions));
    }

    private async __retrieve(
        entityCollectionId: string,
        entityId: string,
        requestOptions?: Entities.RequestOptions,
    ): Promise<core.WithRawResponse<TwelvelabsApi.Entity>> {
        const _response = await core.fetcher({
            url: urlJoin(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.TwelvelabsApiEnvironment.Default,
                `entity-collections/${encodeURIComponent(entityCollectionId)}/entities/${encodeURIComponent(entityId)}`,
            ),
            method: "GET",
            headers: {
                "X-Fern-Language": "JavaScript",
                "X-Fern-SDK-Name": "twelvelabs-js",
                "X-Fern-SDK-Version": "1.2.0-beta.0",
                "User-Agent": "twelvelabs-js/1.2.0-beta.0",
                "X-Fern-Runtime": core.RUNTIME.type,
                "X-Fern-Runtime-Version": core.RUNTIME.version,
                ...(await this._getCustomAuthorizationHeaders()),
                ...requestOptions?.headers,
            },
            contentType: "application/json",
            requestType: "json",
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.Entity.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new TwelvelabsApi.BadRequestError(_response.error.body, _response.rawResponse);
                default:
                    throw new errors.TwelvelabsApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.TwelvelabsApiError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.TwelvelabsApiTimeoutError(
                    "Timeout exceeded when calling GET /entity-collections/{entity_collection_id}/entities/{entity_id}.",
                );
            case "unknown":
                throw new errors.TwelvelabsApiError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * This method deletes a specific entity from an entity collection. It permanently removes the entity and its associated data, but does not affect the assets associated with this entity.
     *
     * @param {string} entityCollectionId - The unique identifier of the entity collection containing the entity to be deleted.
     * @param {string} entityId - The unique identifier of the entity to delete.
     * @param {Entities.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link TwelvelabsApi.BadRequestError}
     *
     * @example
     *     await client.entityCollections.entities.delete("6298d673f1090f1100476d4c", "6298d673f1090f1100476d4c")
     */
    public delete(
        entityCollectionId: string,
        entityId: string,
        requestOptions?: Entities.RequestOptions,
    ): core.HttpResponsePromise<void> {
        return core.HttpResponsePromise.fromPromise(this.__delete(entityCollectionId, entityId, requestOptions));
    }

    private async __delete(
        entityCollectionId: string,
        entityId: string,
        requestOptions?: Entities.RequestOptions,
    ): Promise<core.WithRawResponse<void>> {
        const _response = await core.fetcher({
            url: urlJoin(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.TwelvelabsApiEnvironment.Default,
                `entity-collections/${encodeURIComponent(entityCollectionId)}/entities/${encodeURIComponent(entityId)}`,
            ),
            method: "DELETE",
            headers: {
                "X-Fern-Language": "JavaScript",
                "X-Fern-SDK-Name": "twelvelabs-js",
                "X-Fern-SDK-Version": "1.2.0-beta.0",
                "User-Agent": "twelvelabs-js/1.2.0-beta.0",
                "X-Fern-Runtime": core.RUNTIME.type,
                "X-Fern-Runtime-Version": core.RUNTIME.version,
                ...(await this._getCustomAuthorizationHeaders()),
                ...requestOptions?.headers,
            },
            contentType: "application/json",
            requestType: "json",
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return { data: undefined, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new TwelvelabsApi.BadRequestError(_response.error.body, _response.rawResponse);
                default:
                    throw new errors.TwelvelabsApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.TwelvelabsApiError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.TwelvelabsApiTimeoutError(
                    "Timeout exceeded when calling DELETE /entity-collections/{entity_collection_id}/entities/{entity_id}.",
                );
            case "unknown":
                throw new errors.TwelvelabsApiError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * This method updates the specified entity within an entity collection. This operation allows modification of the entity's name, description, or metadata. Note that this endpoint does not affect the assets associated with the entity.
     *
     * @param {string} entityCollectionId - The unique identifier of the entity collection containing the entity to be updated.
     * @param {string} entityId - The unique identifier of the entity to update.
     * @param {TwelvelabsApi.entityCollections.EntitiesUpdateRequest} request
     * @param {Entities.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link TwelvelabsApi.BadRequestError}
     *
     * @example
     *     await client.entityCollections.entities.update("6298d673f1090f1100476d4c", "6298d673f1090f1100476d4c")
     */
    public update(
        entityCollectionId: string,
        entityId: string,
        request: TwelvelabsApi.entityCollections.EntitiesUpdateRequest = {},
        requestOptions?: Entities.RequestOptions,
    ): core.HttpResponsePromise<TwelvelabsApi.Entity> {
        return core.HttpResponsePromise.fromPromise(
            this.__update(entityCollectionId, entityId, request, requestOptions),
        );
    }

    private async __update(
        entityCollectionId: string,
        entityId: string,
        request: TwelvelabsApi.entityCollections.EntitiesUpdateRequest = {},
        requestOptions?: Entities.RequestOptions,
    ): Promise<core.WithRawResponse<TwelvelabsApi.Entity>> {
        const _response = await core.fetcher({
            url: urlJoin(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.TwelvelabsApiEnvironment.Default,
                `entity-collections/${encodeURIComponent(entityCollectionId)}/entities/${encodeURIComponent(entityId)}`,
            ),
            method: "PATCH",
            headers: {
                "X-Fern-Language": "JavaScript",
                "X-Fern-SDK-Name": "twelvelabs-js",
                "X-Fern-SDK-Version": "1.2.0-beta.0",
                "User-Agent": "twelvelabs-js/1.2.0-beta.0",
                "X-Fern-Runtime": core.RUNTIME.type,
                "X-Fern-Runtime-Version": core.RUNTIME.version,
                ...(await this._getCustomAuthorizationHeaders()),
                ...requestOptions?.headers,
            },
            contentType: "application/json",
            requestType: "json",
            body: serializers.entityCollections.EntitiesUpdateRequest.jsonOrThrow(request, {
                unrecognizedObjectKeys: "strip",
            }),
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.Entity.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new TwelvelabsApi.BadRequestError(_response.error.body, _response.rawResponse);
                default:
                    throw new errors.TwelvelabsApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.TwelvelabsApiError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.TwelvelabsApiTimeoutError(
                    "Timeout exceeded when calling PATCH /entity-collections/{entity_collection_id}/entities/{entity_id}.",
                );
            case "unknown":
                throw new errors.TwelvelabsApiError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * This method adds assets to the specified entity within an entity collection. Assets are used to identify the entity in media content, and adding multiple assets can improve the accuracy of entity recognition in searches.
     *
     * When assets are added, the entity may temporarily enter the "processing" state while the platform updates the necessary data. Once processing is complete, the entity status will return to "ready."
     *
     * @param {string} entityCollectionId - The unique identifier of the entity collection that contains the entity to which assets will be added.
     * @param {string} entityId - The unique identifier of the entity within the specified entity collection to which the assets will be added.
     * @param {TwelvelabsApi.entityCollections.EntitiesCreateAssetsRequest} request
     * @param {Entities.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link TwelvelabsApi.BadRequestError}
     *
     * @example
     *     await client.entityCollections.entities.createAssets("6298d673f1090f1100476d4c", "6298d673f1090f1100476d4c", {
     *         assetIds: ["6298d673f1090f1100476d4c", "6298d673f1090f1100476d4d"]
     *     })
     */
    public createAssets(
        entityCollectionId: string,
        entityId: string,
        request: TwelvelabsApi.entityCollections.EntitiesCreateAssetsRequest,
        requestOptions?: Entities.RequestOptions,
    ): core.HttpResponsePromise<TwelvelabsApi.Entity> {
        return core.HttpResponsePromise.fromPromise(
            this.__createAssets(entityCollectionId, entityId, request, requestOptions),
        );
    }

    private async __createAssets(
        entityCollectionId: string,
        entityId: string,
        request: TwelvelabsApi.entityCollections.EntitiesCreateAssetsRequest,
        requestOptions?: Entities.RequestOptions,
    ): Promise<core.WithRawResponse<TwelvelabsApi.Entity>> {
        const _response = await core.fetcher({
            url: urlJoin(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.TwelvelabsApiEnvironment.Default,
                `entity-collections/${encodeURIComponent(entityCollectionId)}/entities/${encodeURIComponent(entityId)}/assets`,
            ),
            method: "POST",
            headers: {
                "X-Fern-Language": "JavaScript",
                "X-Fern-SDK-Name": "twelvelabs-js",
                "X-Fern-SDK-Version": "1.2.0-beta.0",
                "User-Agent": "twelvelabs-js/1.2.0-beta.0",
                "X-Fern-Runtime": core.RUNTIME.type,
                "X-Fern-Runtime-Version": core.RUNTIME.version,
                ...(await this._getCustomAuthorizationHeaders()),
                ...requestOptions?.headers,
            },
            contentType: "application/json",
            requestType: "json",
            body: serializers.entityCollections.EntitiesCreateAssetsRequest.jsonOrThrow(request, {
                unrecognizedObjectKeys: "strip",
            }),
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.Entity.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new TwelvelabsApi.BadRequestError(_response.error.body, _response.rawResponse);
                default:
                    throw new errors.TwelvelabsApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.TwelvelabsApiError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.TwelvelabsApiTimeoutError(
                    "Timeout exceeded when calling POST /entity-collections/{entity_collection_id}/entities/{entity_id}/assets.",
                );
            case "unknown":
                throw new errors.TwelvelabsApiError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    /**
     * This method removes from the specified entity. Assets are used to identify the entity in media content, and removing assets may impact the accuracy of entity recognition in searches if too few assets remain.
     *
     * When assets are removed, the entity may temporarily enter a "processing" state while the system updates the necessary data. Once processing is complete, the entity status will return to "ready."
     *
     * <Note title="Notes">
     *   - This operation only removes the association between the entity and the specified assets; it does not delete the assets themselves.
     *   - An entity must always have at least one asset associated with it. You can't remove the last asset from an entity.
     * </Note>
     *
     * @param {string} entityCollectionId - The unique identifier of the entity collection that contains the entity from which assets will be removed.
     * @param {string} entityId - The unique identifier of the entity within the specified entity collection from which the assets will be removed.
     * @param {TwelvelabsApi.entityCollections.EntitiesDeleteAssetsRequest} request
     * @param {Entities.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link TwelvelabsApi.BadRequestError}
     *
     * @example
     *     await client.entityCollections.entities.deleteAssets("6298d673f1090f1100476d4c", "6298d673f1090f1100476d4c", {
     *         assetIds: ["6298d673f1090f1100476d4e", "6298d673f1090f1100476d4f"]
     *     })
     */
    public deleteAssets(
        entityCollectionId: string,
        entityId: string,
        request: TwelvelabsApi.entityCollections.EntitiesDeleteAssetsRequest,
        requestOptions?: Entities.RequestOptions,
    ): core.HttpResponsePromise<TwelvelabsApi.Entity> {
        return core.HttpResponsePromise.fromPromise(
            this.__deleteAssets(entityCollectionId, entityId, request, requestOptions),
        );
    }

    private async __deleteAssets(
        entityCollectionId: string,
        entityId: string,
        request: TwelvelabsApi.entityCollections.EntitiesDeleteAssetsRequest,
        requestOptions?: Entities.RequestOptions,
    ): Promise<core.WithRawResponse<TwelvelabsApi.Entity>> {
        const _response = await core.fetcher({
            url: urlJoin(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.TwelvelabsApiEnvironment.Default,
                `entity-collections/${encodeURIComponent(entityCollectionId)}/entities/${encodeURIComponent(entityId)}/assets`,
            ),
            method: "DELETE",
            headers: {
                "X-Fern-Language": "JavaScript",
                "X-Fern-SDK-Name": "twelvelabs-js",
                "X-Fern-SDK-Version": "1.2.0-beta.0",
                "User-Agent": "twelvelabs-js/1.2.0-beta.0",
                "X-Fern-Runtime": core.RUNTIME.type,
                "X-Fern-Runtime-Version": core.RUNTIME.version,
                ...(await this._getCustomAuthorizationHeaders()),
                ...requestOptions?.headers,
            },
            contentType: "application/json",
            requestType: "json",
            body: serializers.entityCollections.EntitiesDeleteAssetsRequest.jsonOrThrow(request, {
                unrecognizedObjectKeys: "strip",
            }),
            timeoutMs: requestOptions?.timeoutInSeconds != null ? requestOptions.timeoutInSeconds * 1000 : 60000,
            maxRetries: requestOptions?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
        });
        if (_response.ok) {
            return {
                data: serializers.Entity.parseOrThrow(_response.body, {
                    unrecognizedObjectKeys: "passthrough",
                    allowUnrecognizedUnionMembers: true,
                    allowUnrecognizedEnumValues: true,
                    breadcrumbsPrefix: ["response"],
                }),
                rawResponse: _response.rawResponse,
            };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new TwelvelabsApi.BadRequestError(_response.error.body, _response.rawResponse);
                default:
                    throw new errors.TwelvelabsApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        switch (_response.error.reason) {
            case "non-json":
                throw new errors.TwelvelabsApiError({
                    statusCode: _response.error.statusCode,
                    body: _response.error.rawBody,
                    rawResponse: _response.rawResponse,
                });
            case "timeout":
                throw new errors.TwelvelabsApiTimeoutError(
                    "Timeout exceeded when calling DELETE /entity-collections/{entity_collection_id}/entities/{entity_id}/assets.",
                );
            case "unknown":
                throw new errors.TwelvelabsApiError({
                    message: _response.error.errorMessage,
                    rawResponse: _response.rawResponse,
                });
        }
    }

    protected async _getCustomAuthorizationHeaders() {
        const apiKeyValue = await core.Supplier.get(this._options.apiKey);
        return { "x-api-key": apiKeyValue };
    }
}
